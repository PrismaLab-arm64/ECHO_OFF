<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000084">
    <meta name="description" content="ECHO_OFF - Comunicación P2P cifrada estilo MS-DOS/Windows 95">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>C:\ECHO_OFF.EXE v1.1.1</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="icon-app.png">
    <link rel="apple-touch-icon" href="icon-app.png">
</head>
<body>
    <!-- PWA Install Prompt -->
    <div id="install-prompt" class="install-prompt hidden">
        <div class="dos-window">
            <div class="dos-title-bar">
                <span>INSTALAR APLICACIÓN</span>
                <button class="dos-close" id="btn-cancel-install">✕</button>
            </div>
            <div class="dos-content">
                <p>╔═══════════════════════════════════════════╗</p>
                <p>║  ¿Instalar ECHO_OFF en este equipo?     ║</p>
                <p>║                                           ║</p>
                <p>║  La aplicación funcionará sin conexión   ║</p>
                <p>╚═══════════════════════════════════════════╝</p>
                <div class="dos-buttons">
                    <button id="btn-install" class="dos-button">[ SÍ ]</button>
                    <button class="dos-button">[ NO ]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Boot Screen -->
    <div id="splash-screen" class="boot-screen active">
        <div class="boot-content">
            <pre class="boot-text">
Starting MS-DOS...

ECHO_OFF Secure Communications System v1.1.0
Copyright (C) 2026 CyberSec Division

Initializing P2P Protocol...      [OK]
Loading Encryption Module...      [OK]
Checking Memory...                [640K OK]
Starting PeerJS Service...        [OK]

Type HELP for available commands.

C:\></pre>
            <span class="cursor-blink">_</span>
        </div>
    </div>
    
    <!-- Main DOS Window -->
    <div id="terminal" class="dos-terminal hidden">
        <!-- Title Bar -->
        <div class="dos-title-bar">
            <span>C:\ECHO_OFF.EXE</span>
            <div class="dos-controls">
                <button class="dos-minimize">_</button>
                <button class="dos-maximize">□</button>
                <button class="dos-close">✕</button>
            </div>
        </div>

        <!-- Menu Bar -->
        <div class="dos-menu-bar">
            <span class="menu-item">Archivo</span>
            <span class="menu-item">Conexión</span>
            <span class="menu-item">Opciones</span>
            <span class="menu-item">Ayuda</span>
            <div class="status-bar-right">
                <span id="status" class="status-text">● DESCONECTADO</span>
            </div>
        </div>

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
            <pre class="dos-art">
╔═══════════════════════════════════════════════════════════════╗
║                                                               ║
║   ███████╗ ██████╗██╗  ██╗ ██████╗     ╔═══════════════╗    ║
║   ██╔════╝██╔════╝██║  ██║██╔═══██╗    ║  ███████╗     ║    ║
║   █████╗  ██║     ███████║██║   ██║    ║  ██╔═══██╗    ║    ║
║   ██╔══╝  ██║     ██╔══██║██║   ██║    ║  ██║   ██║    ║    ║
║   ███████╗╚██████╗██║  ██║╚██████╔╝    ║  ╚██████╔╝    ║    ║
║   ╚══════╝ ╚═════╝╚═╝  ╚═╝ ╚═════╝     ║   ╚═════╝     ║    ║
║                                         ║               ║    ║
║   SISTEMA DE COMUNICACIÓN SEGURA       ║  ███████╗██╗  ║    ║
║   Versión 1.1.0 - MS-DOS Compatible    ║  ██╔════╝██║  ║    ║
║                                         ║  █████╗  ██║  ║    ║
║   Protocolo: Peer-to-Peer (P2P)        ║  ██╔══╝  ██║  ║    ║
║   Encriptación: End-to-End             ║  ██║     ██║  ║    ║
║   Almacenamiento: NINGUNO              ║  ╚═╝     ╚═╝  ║    ║
║   Privacidad: MÁXIMA                   ╚═══════════════╝    ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝

C:\> Seleccione una opción:
            </pre>
            
            <div class="dos-button-container">
                <button id="btn-create-room" class="dos-button primary">
                    [ 1 ] CREAR NUEVA SALA
                </button>
                <button id="btn-join-room" class="dos-button primary">
                    [ 2 ] UNIRSE A SALA EXISTENTE
                </button>
            </div>
        </div>

        <!-- Room Creation Screen -->
        <div id="create-room-screen" class="screen">
            <pre class="dos-screen-content">
╔═══════════════════════════════════════════════════════════════╗
║                     CREAR NUEVA SALA                          ║
╚═══════════════════════════════════════════════════════════════╝

C:\> Generando ID único de sala...

┌───────────────────────────────────────────────────────────────┐
│ ID DE SALA GENERADO:                                          │
            </pre>
            <div class="dos-id-display">
                <input type="text" id="room-id" readonly class="dos-input" />
                <button id="btn-copy-id" class="dos-button-small">COPIAR</button>
            </div>
            <pre class="dos-screen-content">
│                                                               │
│ ⚠ ADVERTENCIA: Comparta este ID únicamente con usuarios      │
│   de confianza. Cualquier persona con este ID puede          │
│   conectarse a su sala de chat.                              │
└───────────────────────────────────────────────────────────────┘

C:\> Estado: Esperando conexiones entrantes...
C:\> Presione ESC para cancelar
            </pre>
            <button id="btn-back-from-create" class="dos-button">
                [ ESC ] VOLVER AL MENÚ PRINCIPAL
            </button>
        </div>

        <!-- Room Join Screen -->
        <div id="join-room-screen" class="screen">
            <pre class="dos-screen-content">
╔═══════════════════════════════════════════════════════════════╗
║                   UNIRSE A SALA EXISTENTE                     ║
╚═══════════════════════════════════════════════════════════════╝

C:\> Ingrese el ID de la sala objetivo:

┌───────────────────────────────────────────────────────────────┐
│ ID DEL PEER:                                                  │
            </pre>
            <div class="dos-input-group">
                <input type="text" id="peer-id-input" placeholder="ECHO_XXXXXXXXXX" class="dos-input" />
            </div>
            <pre class="dos-screen-content">
└───────────────────────────────────────────────────────────────┘

C:\> Presione ENTER para conectar
            </pre>
            <div class="dos-button-group">
                <button id="btn-connect" class="dos-button primary">
                    [ ENTER ] CONECTAR
                </button>
                <button id="btn-back-from-join" class="dos-button">
                    [ ESC ] CANCELAR
                </button>
            </div>
        </div>

        <!-- Chat Screen -->
        <div id="chat-screen" class="screen">
            <div class="dos-chat-header">
                <pre>╔═══════════════════════════════════════════════════════════════╗
║ CANAL SEGURO ESTABLECIDO │ PEER: <span id="chat-peer-id" class="peer-id"></span>                  ║
╚═══════════════════════════════════════════════════════════════╝</pre>
                <button id="btn-disconnect" class="dos-button-close">[ DESCONECTAR ]</button>
            </div>
            
            <div id="messages-container" class="dos-messages"></div>
            
            <div class="dos-input-bar">
                <span class="prompt">C:\></span>
                <input 
                    type="text" 
                    id="message-input" 
                    class="dos-message-input"
                    placeholder="Escriba su mensaje..."
                    autocomplete="off"
                />
                <button id="btn-send" class="dos-send-button">ENVIAR</button>
            </div>
        </div>
    </div>

    <!-- PeerJS CDN -->
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
